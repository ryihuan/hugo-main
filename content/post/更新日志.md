---
title: 你好，Stack主题
date: "2025-10-01"
tags: ["Stack", "Hugo"]
draft: false
categories: ["diary"]
---
<small>*本文基于Stack版本3.31.0*</small>

## 从Neopost到Stack
我觉得对于像我这样的代码白痴，一开始装修博客就去选冷门主题真的是走弯路了。用Neopost主题的时候遇到很多问题用搜索引擎都搜不到可以抄作业的答案，只能一个劲问ai然后一遍一遍试错……  
虽然看到博客一点一点有个样子了也比较有满足感，但是太折磨了，思来想去还是换了更多人用教程也更全的Stack主题。

在此感谢：
[莱特雷-Hugo Stack主题自定义更改](https://letere-gzj.github.io/hugo-stack/p/hugo/custom-stack-theme/)；
[树响集-Stack主题调整](https://donbro.vercel.app/p/daima/)；
[第三夏尔-Hugo Stack博客主题装修](https://thirdshire.com/series/hugo-stack-%E5%8D%9A%E5%AE%A2%E4%B8%BB%E9%A2%98%E8%A3%85%E4%BF%AE/)；
[Naive Koala-Hugo Stack 魔改美化](https://www.xalaok.top/post/stack-modify/)

顺便截图纪念一下用Neopost主题时候的样子吧。<details><summary>展开图片</summary>
![Neopost](/p/neopost.png)
</details>

## 从默认字体到猫啃糖圆
没啥好说的，星屑同款字体，圆体的神,  
附上[字体网站链接](https://www.maoken.com/tangyuan)
## 背景图和头像
因为还是很喜欢原来做的像素动图风格，本打算沿用，但在Pintrest找了一晚上素材都没有找到很满意的背景图  
自己画了一下草图，先凑合用着吧（画不画完还是未知数）  
<small>画不来像素风所以整个风格都改了> < </small>

画布开得尽可能大了，姑且应用到网页上看看会多么影响加载速度（
### 切换与旋转效果
按照[教程](https://www.xalaok.top/post/stack-modify/#%E5%A4%B4%E5%83%8F%E6%97%8B%E8%BD%AC)添加了头像旋转效果，并加了浅色/暗色模式切换头像和背景图的功能，效果不错（就是图太草了）  

以下是我魔改的代码：  
<details>
<summary>暗色模式下头像旋转（主题目录\assets\scss\custom.scss）</summary>

```scss
// 头像旋转动画
[data-scheme="dark"] .sidebar header .site-avatar .site-logo {
  transition: transform 1.65s ease-in-out; // 旋转时间
}

[data-scheme="dark"] .sidebar header .site-avatar .site-logo:hover {
  transform: rotate(360deg); // 旋转角度为360度
}
```
</details>
<details>
<summary>切换背景图片（主题目录\layouts\partials\footer\custom.html）</summary>

```css
    /*修改背景图片*/
    [data-scheme="light"] body {
        background: url({{ (resources.Get "background/light.jpg").Permalink }}) no-repeat center top;
        background-size: cover;
        background-attachment: fixed;
    }
    [data-scheme="dark"] body {
        background: url({{ (resources.Get "background/dark.jpg").Permalink }}) no-repeat center top;
        background-size: cover;
        background-attachment: fixed;
    }
```
</details>
<details>
<summary>切换头像</summary>

先修改`主题目录\layouts\partials\head\custom.html`
```html
<script>
// 头像切换功能
function updateAvatar() {
  const avatarImg = document.querySelector('.site-avatar .site-logo');
  if (!avatarImg) return;
  
  const isDark = document.documentElement.getAttribute('data-scheme') === 'dark';
  const lightSrc = avatarImg.getAttribute('data-src-light') || avatarImg.src;
  const darkSrc = avatarImg.getAttribute('data-src-dark');
  
  if (darkSrc && isDark) {
    avatarImg.src = darkSrc;
  } else if (lightSrc && !isDark) {
    avatarImg.src = lightSrc;
  }
}

// 初始化
document.addEventListener('DOMContentLoaded', updateAvatar);

// 监听主题切换
new MutationObserver(function(mutations) {
  mutations.forEach(function(mutation) {
    if (mutation.attributeName === 'data-scheme') {
      setTimeout(updateAvatar, 50);
    }
  });
}).observe(document.documentElement, { attributes: true });
</script>
```
再修改`主题目录\layouts\partials\sidebar\left.html`（在`<header>`后修改，注释掉原有设置）
```html
<header>
    {{ with .Site.Params.sidebar.avatar }}
        {{ if (default true .enabled) }}
        <figure class="site-avatar">
            <a href="{{ .Site.BaseURL | relLangURL }}">
            {{ if not .local }}
                <img src="{{ .src }}" width="300" height="300" class="site-logo" loading="lazy" alt="Avatar"
                    {{ with .srcDark }}data-src-dark="{{ . }}"{{ end }}>
            {{ else }}
                {{ $avatar := resources.Get (.src) }}
                {{ $avatarDark := resources.Get (.srcDark | default .src) }}
                
                {{ if and $avatar $avatarDark }}
                    {{ $avatarResized := $avatar.Resize "300x" }}
                    {{ $avatarDarkResized := $avatarDark.Resize "300x" }}
                    <img src="{{ $avatarResized.RelPermalink }}" 
                        data-src-light="{{ $avatarResized.RelPermalink }}"
                        data-src-dark="{{ $avatarDarkResized.RelPermalink }}"
                        width="{{ $avatarResized.Width }}" 
                        height="{{ $avatarResized.Height }}" 
                        class="site-logo" 
                        loading="lazy" 
                        alt="Avatar">
                {{ else if $avatar }}
                    {{ $avatarResized := $avatar.Resize "300x" }}
                    <img src="{{ $avatarResized.RelPermalink }}" 
                        width="{{ $avatarResized.Width }}"
                        height="{{ $avatarResized.Height }}" 
                        class="site-logo" 
                        loading="lazy" 
                        alt="Avatar">
                {{ else }}
                    {{ errorf "Failed loading avatar from %q" . }}
                {{ end }}
            {{ end }}
            </a>
            {{ with $.Site.Params.sidebar.emoji }}
                <span class="emoji">{{ . }}</span>
            {{ end }}
        </figure>
        {{ end }}
    {{ end }}
```
再在`hugo.yaml`的`sidebar`里面添加`srcdark: img/dark.jpg`
```yaml
    sidebar:
        emoji: 😨
        subtitle: Lorem ipsum dolor sit amet, consectetur adipiscing elit.
        avatar:
            enabled: true
            local: true
            src: img/light.jpg
            srcdark: img/dark.jpg
```
</details>

顺说目前的回顶部按钮和鼠标光标是用neopost主题的时候自己画的，我很满意^ ^  
<img src="/p/backtop.png" alt="回顶部" width=32px />![默认](/p/default.png)![点击](/p/pointer.png)![文本](/p/text.png)  
不过考虑到风格不匹配大概还要重画一个……

## 更换头像下图标链接
苦于没找到合适的图标素材，自己摸索了一个可以制作出完美适配主题下其他现有图标的办法

先看我做好的图标：![Misskey](/p/misskey.svg)![bluesky](/p/bluesky.svg) <small>（这样看起来两个线条粗细不太一致，我也没找到原因，但没关系，最终显示效果是差不多的就行……如果有谁知道为什么，请务必告诉我）</small>  
![效果](/p/效果.png)  

如果有同款需要，可以直接右键上面的图标另存^ ^

### 寻找svg素材
这里有一个很全的资源网站：[维基共享资源](https://commons.wikimedia.org/wiki/%E9%A6%96%E9%A1%B5?uselang=zh-cn)  
搜索你需要的logo，比如“bluesky”，选择`图像-文件类型-svg`，选择合适的logo并在下载时选择`full resolution`，这样我们就能得到一张初始的svg文件：  
<details><summary>展开图像</summary>

![bluesky](/p/初始-bluesky.svg)
</details>

### 编辑svg文件
使用编辑工具对svg文件进行编辑，这里我用的是[一个免费的在线svg编辑工具（需要注册）](https://boxy-svg.com/)

主要需要做的是先把view box调到24x24像素，再把图像调整到view box范围内，四周适当留出2px左右的空白（视具体图像而定），之后就可以保存了  
<details><summary>展开图像</summary>  
<img src=/p/100201.png alt="调整view box" width=100% /> <img src=/p/100202.png alt=调整图像 width=100% /></details>

把保存的svg文件在VScode里打开，默认会显示图像预览，需要在右上角找到`作为源文本重新打开`按钮，查看源文本  
为了跟主题原有的图标协调，这里我同时打开了`主题目录\assets\icons\brand-twitter.svg`的源文本进行比对：
<details><summary>brand-twitter.svg</summary>

```svg
<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M22 4.01c-1 .49 -1.98 .689 -3 .99c-1.121 -1.265 -2.783 -1.335 -4.38 -.737s-2.643 2.06 -2.62 3.737v1c-3.245 .083 -6.135 -1.395 -8 -4c0 0 -4.182 7.433 4 11c-1.872 1.247 -3.739 2.088 -6 2c3.308 1.803 6.913 2.423 10.034 1.517c3.58 -1.04 6.522 -3.723 7.651 -7.742a13.84 13.84 0 0 0 .497 -3.753c-.002 -.249 1.51 -2.772 1.818 -4.013z" />
</svg>
```
</details>

可以直接复制前面两行代码粘贴到正在修改的svg文件中：
<details><summary>未编辑的svg文件源文本</summary>

![图像](/p/Untitled.svg)
```svg
<?xml version="1.0" encoding="utf-8"?>
<svg width="24px" height="24px" version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
  <path d="M 6.307 4.451 C 8.615 6.202 11.099 9.759 12.012 11.668 C 12.923 9.76 15.407 6.202 17.717 4.451 C 19.383 3.185 22.083 2.207 22.083 5.321 C 22.083 5.944 21.73 10.549 21.524 11.294 C 20.804 13.893 18.184 14.557 15.854 14.155 C 19.928 14.858 20.964 17.179 18.726 19.501 C 14.477 23.912 12.618 18.395 12.14 16.981 C 12.054 16.722 12.012 16.6 12.012 16.703 C 12.012 16.6 11.97 16.722 11.882 16.981 C 11.407 18.395 9.547 23.912 5.297 19.501 C 3.059 17.179 4.095 14.858 8.17 14.155 C 5.837 14.557 3.219 13.893 2.499 11.294 C 2.294 10.549 1.94 5.944 1.94 5.321 C 1.94 2.207 4.64 3.185 6.307 4.451 Z" style="transform-box: fill-box; transform-origin: 50% 50%;" fill="#000"/>
</svg>
```
</details>

注意删除正在修改的文件`<path>`末尾的样式（如`style=""`、`fill=""`、`stroke=""`等等，总之只保留前面一连串看不懂的数字）
<details><summary>编辑后的源文本</summary>

![图像](/p/bluesky2.svg)
```svg
<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-bluesky" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M 6.307 4.451 C 8.615 6.202 11.099 9.759 12.012 11.668 C 12.923 9.76 15.407 6.202 17.717 4.451 C 19.383 3.185 22.083 2.207 22.083 5.321 C 22.083 5.944 21.73 10.549 21.524 11.294 C 20.804 13.893 18.184 14.557 15.854 14.155 C 19.928 14.858 20.964 17.179 18.726 19.501 C 14.477 23.912 12.618 18.395 12.14 16.981 C 12.054 16.722 12.012 16.6 12.012 16.703 C 12.012 16.6 11.97 16.722 11.882 16.981 C 11.407 18.395 9.547 23.912 5.297 19.501 C 3.059 17.179 4.095 14.858 8.17 14.155 C 5.837 14.557 3.219 13.893 2.499 11.294 C 2.294 10.549 1.94 5.944 1.94 5.321 C 1.94 2.207 4.64 3.185 6.307 4.451 Z" style="transform-box: fill-box; transform-origin: 50% 50%;" />
</svg>
```
</details>

这样一个适配主题的svg图标就做好了。  
### 应用到主页
把做好的文件放到`主题目录\assets\icons\`中，并在`hugo/yaml`里修改`menu-social-icon`的设置（与文件的标题一致），这样就可以应用到博客页面上了  
如果需要更改图标链接的顺序，在`params:`前面一行添加`weight: 数字`即可，数字越小则越前



