<script>
// 头像切换功能
function updateAvatar() {
  const avatarImg = document.querySelector('.site-avatar .site-logo');
  if (!avatarImg) return;
  
  const isDark = document.documentElement.getAttribute('data-scheme') === 'dark';
  const lightSrc = avatarImg.getAttribute('data-src-light') || avatarImg.src;
  const darkSrc = avatarImg.getAttribute('data-src-dark');
  
  if (darkSrc && isDark) {
    avatarImg.src = darkSrc;
    // 触发旋转动画
    triggerAvatarAnimation(avatarImg);
  } else if (lightSrc && !isDark) {
    avatarImg.src = lightSrc;
  }
}

// 触发头像动画
function triggerAvatarAnimation(avatarImg) {
  avatarImg.classList.add('rotating-overshoot');
  setTimeout(() => {
    avatarImg.classList.remove('rotating-overshoot');
  }, 2000); // 动画时长2秒
}

// 初始化
document.addEventListener('DOMContentLoaded', updateAvatar);

// 监听主题切换
new MutationObserver(function(mutations) {
  mutations.forEach(function(mutation) {
    if (mutation.attributeName === 'data-scheme') {
      setTimeout(updateAvatar, 50);
    }
  });
}).observe(document.documentElement, { attributes: true });
</script>

<!-- 扩大主页文章卡片可点击区域 -->
<script>
document.addEventListener('click', function(e) {
    const articleDetails = e.target.closest('.article-details');
    if (articleDetails && !e.target.closest('.article-category a')) {
        const titleLink = articleDetails.querySelector('.article-title a');
        if (titleLink) {
            window.location.href = titleLink.href;
        }
    }
});
</script>
